---
global_config_detected:
  cloud_orchestrator: "{{ cloud_orchestrator }}"
  controller_list: "{{ controller_list }}"
  analytics_list: "{{ analytics_list }}"
  analyticsdb_list: "{{ analyticsdb_list }}"
  compute_list: "{{ compute_list }}"
  nested_mode: "{{ nested_mode }}"
  config_ip: "{{ config_ip }}"
  controller_ip: "{{ controller_ip }}"
  analytics_ip: "{{ analytics_ip }}"
  enable_config_service: "{{ enable_config_service }}"
  enable_control_service: "{{ enable_control_service }}"
  enable_webui_service: "{{ enable_webui_service }}"
  config_server_list: "{{ config_server_list if config_server_list else config_server_list_derived }}"
agent_compile_vrouter_module_orig: "{{(agent_compile_vrouter_module is defined) | ternary(agent_compile_vrouter_module, 'undef')}}"
global_config_orig: "{{ global_config_detected | combine(global_config|default({})) | combine(global_config_extra|default({})) }} "
non_bare_metal_vrouter_compile: "{{ (agent_compile_vrouter_module_orig != 'undef') | ternary(agent_compile_vrouter_module_orig|ternary(true, false), external_vrouter_compile|ternary(false,true)) }}"

#For bare-metal compute in Debian, make sure  compile_vrouter_module is not true
compile_vrouter_module_orig: "{{ (contrail_compute_mode == 'bare_metal') | ternary(false, non_bare_metal_vrouter_compile) }}"
agent_config_orig: "{{ agent_config | default({}) | combine(\
  {'compile_vrouter_module': compile_vrouter_module_orig,\
  'vrouter_physical_interface': vrouter_physical_interface\
  })}}"

controller_group: "{{ groups['contrail-controllers'] | default([]) }}"
analytics_group: "{{ groups['contrail-analytics'] | default([]) }}"
analyticsdb_group: "{{ groups['contrail-analyticsdb'] | default([]) }}"
compute_group: "{{ groups['contrail-compute'] | default([]) }}"
